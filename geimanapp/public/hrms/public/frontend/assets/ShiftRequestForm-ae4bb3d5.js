import{I as q,a as g}from"./index-1b959967.js";import{i as F,a as R,Q as u,w as d,f,z as p,l as c,k as S,q as i,U as V}from"./frappe-ui-02049d65.js";import b from"./FormView-3bc2cd59.js";import"./FormField-1058c29b.js";import"./Link-cfd1cc27.js";import"./FileUploaderView-2c05c13e.js";import"./workflow-0b2a2f3b.js";import"./user-9e8700ad.js";import"./formatters-c2abf875.js";const U={__name:"ShiftRequestForm",props:{id:{type:String,required:!1}},setup(_){const m=F("$employee"),s=_,o=R({}),n=u({url:"hrms.api.get_doctype_fields",params:{doctype:"Shift Request"},auto:!0,transform(e){return s.id?e:e.filter(a=>!["employee","employee_name","status","company"].includes(a.fieldname))}});u({url:"hrms.api.get_shift_request_approvers",params:{employee:m.data.name},auto:!s.id,onSuccess(e){var r,l;const a=(r=n.data)==null?void 0:r.find(t=>t.fieldname==="approver");a.documentList=e==null?void 0:e.map(t=>({label:t.full_name?`${t.name} : ${t.full_name}`:t.name,value:t.name})),o.value.approver=(l=e[0])==null?void 0:l.name}}),d(()=>o.value.employee,e=>{s.id&&e!==m.data.name&&y()}),d(()=>[o.value.from_date,o.value.to_date],([e,a])=>{v(e,a)});function y(){o.value.approver!==m.data.user_id&&n.data.map(e=>e.read_only=!0)}function v(e,a){if(!(e&&a))return;const r=e>a?__("To Date cannot be before From Date"):"",l=n.data.find(t=>t.fieldname==="from_date");l.error_message=r}function h(){o.value.employee=m.data.name}return(e,a)=>(f(),p(i(g),null,{default:c(()=>[S(i(q),{fullscreen:!0},{default:c(()=>[i(n).data?(f(),p(b,{key:0,doctype:"Shift Request",modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=r=>o.value=r),isSubmittable:!0,fields:i(n).data,id:s.id,onValidateForm:h},null,8,["modelValue","fields","id"])):V("",!0)]),_:1})]),_:1}))}};export{U as default};
//# sourceMappingURL=ShiftRequestForm-ae4bb3d5.js.map
